<!--
  @license
  Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
  This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
  The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
  The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
  Code distributed by Google as part of the polymer project is also
  subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
--> <!--
  Modifications made for dumaOS.
  Kian Cross
--> <link rel="import" href="../polymer/polymer.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="../iron-input/iron-input.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="../iron-flex-layout/iron-flex-layout.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="../duma-input-behavior/duma-input-inputs-behavior.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <dom-module id="duma-ip-input-inputs"> <template> <style> :host {
        display: inline-block;
      }

      :host([hidden]) {
        display: none !important;
      }

      input[is="iron-input"] {
        font: inherit;
        outline: none;
        box-shadow: none;
        border: none;
        width: auto;
      }

      .container {
        @apply(--layout-horizontal);
      } </style> <div class="container"> <input allowed-pattern="[0-9]" is="iron-input" maxlength="3" bind-value="{{ip1}}" size="3"> . <input allowed-pattern="[0-9]" is="iron-input" maxlength="3" bind-value="{{ip2}}" size="3"> . <input allowed-pattern="[0-9]" is="iron-input" maxlength="3" bind-value="{{ip3}}" size="3"> . <input allowed-pattern="[0-9]" is="iron-input" maxlength="3" bind-value="{{ip4}}" size="3"> </div> </template> </dom-module> <script> Polymer({
    is: "duma-ip-input-inputs",

    properties: {
      _delimiter: {
        type: String,
        value: "."
      },

      validRanges: {
        type: Array,
        value: ["0.0.0.0/0"]
      }
    },
    
    behaviors: [
      Polymer.IronValidatableBehavior,
      Duma.InputInputsBehavior
    ],
    
    _getValidity: function() {
      function ipToNumber(ip) {
        return (+ip[1] << 24) + (+ip[2] << 16) + (+ip[3] << 8) + (+ip[4]);
      }

      function maskToNumber(mask) {
        return (-1 << (32 - mask));
      }

      var value = this.parts;
      if(value.length == 4) {
        for (var i = 0; i < value.length; i++) {
          if (
            value[i] == "" || Number(value[i]) == NaN ||
            value[i] < 0 || value[i] > 255
          ) {
            return false;
          }
        }
      } else {
        return false;
      }

      var numberIp = ipToNumber(value);
      for (var i = 0; i < this.validRanges.length; i++) {
        var range = this.validRanges[i].split("/");
        if (range.length == 2) {
          if (
            (ipToNumber(range[0]) & maskToNumber(range[1])) ==
            (ipToNumber & maskToNumber(range[1]))
          ) {
            return true;
          }
        }
      } 
      return false;
    }
  }); </script> 