<!--
  (C) 2017 NETDUMA Software
  Kian Cross <kian.cross@netduma.com>
--> <link rel="import" href="../polymer/polymer.html"> <link rel="import" href="/libs/svg-injector.html"> <dom-module id="duma-image"> <template> <style is="custom-style"> :host {
        display: block;
        fill: var(--primary-text-color);
        height: 24px;
        width: 24px;
        transition: fill 200ms ease;        
      } </style> <div id="container"></div> </template> <script> Polymer({
      is: "duma-image",
      properties: {
        src: {
          type: String,
          observer: "_addImage"
        }
      },

      _empty: function (element) {
        var children = Polymer.dom(element).children;

        for (var i = 0; i < children.length; i++) {
          Polymer.dom(element).removeChild(children[i]);
        }
      },

      _injectSvg: function (img) {
        SVGInjector(img, {
          evalScripts: "never"
        });
      },

      _addImage: function () {
        this._empty(this.$$("#container"));
        
        var img = document.createElement("img");
        img.src = this.src;
        this.$$("#container").appendChild(img);

        if (/.+\.svg|.+\.svg\?.*$/) {
          this._injectSvg(img);
        }
      }
    }); </script> </dom-module> 