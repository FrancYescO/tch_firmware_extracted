#!/bin/sh

#init env
wireless_init_uci_env.sh

#Update parameters

board=`uci get env.rip.board_mnemonic`

if [ $board == "VBNT-L" ]; then
uci set wireless.radio_2G.country='AU'
uci set wireless.radio_5G.country='AU'
fi

if [ $board == "GANT-2" ]; then
uci set wireless.radio_2G.country='ID'
uci set wireless.radio_5G.country='ID'
fi

# To make sure it is set to the correct vendor
uci set wireless.radio_2G.type=`wireless_get_radio_type.sh radio_2G`

uci set wireless.wl0.ssid="`uci get env.var.ssid_prefix` `uci get env.var.ssid_mac_postfix_r0 | sed 's/^..//'`"

uci set wireless.ap0.wep_key=`uci get env.var.default_key_r0_s0`

uci set wireless.ap0.wpa_psk_key=`uci get env.var.default_key_r0_s0`

uci set wireless.ap0.wps_ap_pin=`uci get env.var.default_wps_ap_pin_r0_s0`

uci set wireless.ap0_auth0.secret=`uci get env.var.default_key_r0_s0`

# guest wifi 2G
uci set wireless.wl0_1.ssid="`uci get env.var.ssid_prefix`_Guest `uci get env.var.ssid_mac_postfix_r0 | sed 's/^..//'`"

# Is there a dual radio config ?
DUMMY=`uci get wireless.radio_5G`

if [ "$?" == "0" ] ; then
  uci set wireless.radio_5G.type=`wireless_get_radio_type.sh radio_5G`

  uci set wireless.wl1.ssid="`uci get env.var.ssid_prefix` `uci get env.var.ssid_mac_postfix_r0 | sed 's/^..//'`-5GHz"

  uci set wireless.ap1.wep_key=`uci get env.var.default_key_r0_s0`

  uci set wireless.ap1.wpa_psk_key=`uci get env.var.default_key_r0_s0`

  uci set wireless.ap1.wps_ap_pin=`uci get env.var.default_wps_ap_pin_r0_s0`

  uci set wireless.ap1_auth0.secret=`uci get env.var.default_key_r0_s0`

# guest wifi 5G
  uci set wireless.wl1_1.ssid="`uci get env.var.ssid_prefix`_Guest `uci get env.var.ssid_mac_postfix_r0 | sed 's/^..//'`-5GHz"

fi

uci commit wireless
