<link rel="import" href="/custom-elements/polymer/polymer.html"> <link rel="import" href="/apps/com.netdumasoftware.benchmark/desktop/DomModules/rating.html"> <link rel="import" href="/libs/jquery.html"> <dom-module id="duma-ping-rating"> <template> <style> </style> <!-- local DOM HTML --> <duma-rating id="rating" animated="[[animated]]" tooltip="[[tooltip]]" tooltip-icons="[[tooltipIcons]]" thresholds="[[thresholds]]"></duma-rating> </template> <script> Polymer(
    {
      is: 'duma-ping-rating',
      properties:
      {
        animated:
        {
          type: Boolean,
          value: false,
        },
        thresholds:
        {
          type: Object,
          value:
          {
            max: 80,

            limits: 
            [
              {
                letter: "D",
                limit: 20,
                colour: "<%= theme.RATING_D %>",
              },
              {
                letter: "C",
                limit: 30,
                colour: "<%= theme.RATING_C %>",
              },
              {
                letter: "B",
                limit: 45,
                colour: "<%= theme.RATING_B %>",
              },
              {
                letter: "A",
                limit: 55,
                colour: "<%= theme.RATING_A %>",
              },
              {
                letter: "A+",
                limit: 60,
                colour: "<%= theme.RATING_APLUS %>",
              }
            ],
          }
        },
        tooltipIcons:
        {
          type: Object,
          value:
          {
            0: "schedule",
            1: "schedule",
            2: "schedule",
          },
        },
        tooltip:
        {
          type: Object,
          value: function ()
          {
            return {
              line0: "",
              line1: "",
              line2: "",
            };
          },
        },
      },

      // Upload and download as percentages of expected speeds
      setRating: function (ping, jitter, droppedPercent)
      {
        var droppedPackets = droppedPercent;
        // Ping rating is calculated by adding the average ping and jitter
        // then dropping 10 points (typically a whole level) for every dropped packet
        var score = Math.min(Math.max((80 - ping) + jitter - (10 * droppedPackets), 0), 80);

        this.$.rating.setRating(score);
      },

      reset: function ()
      {
        this.$.rating.reset();
      },
    }); </script> </dom-module> 