<!--
  (C) 2016 NETDUMA Software
  Kian Cross
--> <%
require "libos"
require "libtable"
local platform_information = os.platform_information()
%> <link rel="import" href="/custom-elements/duma-panels/duma-panel.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/duma-chart/duma-chart.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/paper-button/paper-button.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/paper-input/paper-input.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/paper-dialog/paper-dialog.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/paper-checkbox/paper-checkbox.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/paper-input/paper-textarea.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/paper-dropdown-menu/paper-dropdown-menu.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/paper-listbox/paper-listbox.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/paper-item/paper-item.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/paper-dialog/paper-dialog.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/paper-spinner/paper-spinner-lite.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/paper-dialog/paper-dialog.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/paper-dialog-scrollable/paper-dialog-scrollable.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/iron-collapse/iron-collapse.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/themes/<%= current_theme %>/duma-theme.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/custom-elements/iron-flex-layout/iron-flex-layout-classes.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/libs/jquery.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/libs/colours.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/libs/sampler.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/libs/util.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <link rel="import" href="/apps/com.netdumasoftware.geofilter/desktop/geo-filter.html?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"> <style is="custom-style" include="iron-flex iron-positioning iron-flex-factors duma-theme"> #ping-graph {
    height: 100%;
  }
  
  #allow-deny {
    --paper-input-container: {
      padding-top: 0;
    };
  }
  @media only screen and (min-width: 1600px) {
    div#allow-deny {
      @apply(--layout-horizontal);
    }
    div#allow-deny .buttons {
      padding-left: 16px;
    }
  }
  label {
    color: var(--secondary-text-color);
    padding-right: 8px;
  }

  .chart-container {
    @apply(--layout);
  }

  table.auto {
    width: auto;
  }

  span#domain {
    word-break: break-all;
  }
  .toggle-info {
    transform: rotate(0);
    transition: transform ease-in-out 150ms;
  }
  .toggle-info.expanded {
    transform: rotate(180);
  }
  #report-other {
    min-width: 17vw;
  } </style> <duma-panel id="ping-panel" show-close show-pin show-help show-help-tip> <div help-content> <p> <%= i18n.helpContent %> </p> </div> <div help-tip> <%= i18n.helpTip %> </div> <div main class="vertical"> <div class="layout vertical flex" id="ping-information"> <div class="flex-none layout horizontal"> <div class="flex"> <table id="host-statistics"> <tr class="ping"> <th><%= i18n.ping %></th> <td><span class="value"></span> <%= i18n.msUnit %></td> </tr> <% if not table.find({"XR300", "R7000"}, platform_information.model) then %> <tr class="server-tick-rate"> <th scope="row"><%= i18n.hostTickRate %></th> <td class="value"></td> </tr> <tr class="client-tick-rate"> <th scope="row"><%= i18n.clientTickRate %></th> <td class="value"></td> </tr> <% end %> <tr class="send-rate"> <th scope="row"><%= i18n.sendRate %></th> <td><span class="value"></span> <%= i18n.kbpsUnit %></td> </tr> <tr class="receive-rate"> <th scope="row"><%= i18n.receiveRate %></th> <td><span class="value"></span> <%= i18n.kbpsUnit %></td> </tr> <tr class="host-type"> <th scope="row"><%= i18n.hostType %></th> <td> <span class="value"></span> </td> </tr> <tr class="id"> <th scope="row"><%= i18n.id %></th> <td> <span class="value"></span> </td> </tr> <% if platform_information.vendor ~= "TELSTRA" then %> <tr class="domain"> <th scope="row"><%= i18n.domainName %></th> <td> <span class="value"></span> </td> </tr> <% end %> </table> </div> <div class="flex"> <table id="overflow-table"> <tr class="host-type"> <th scope="row"><%= i18n.hostType %></th> <td> <span class="value"></span> </td> </tr> <tr class="id"> <th scope="row"><%= i18n.id %></th> <td> <span class="value"></span> </td> </tr> <% if platform_information.vendor ~= "TELSTRA" then %> <tr class="domain"> <th scope="row"><%= i18n.domainName %></th> <td> <span class="value"></span> </td> </tr> <% end %> </table> <div id="allow-deny" class="content layout"> <paper-input class="flex-auto" id="host-name" auto-validate maxlength="20" char-counter always-float-label label="<%= i18n.hostNameLabel %>" error-message="<%= i18n.hostNameError %>"></paper-input> <div class="buttons layout horizontal"> <paper-button background id="allow"><%= i18n.allow %></paper-button> <paper-button id="deny"><%= i18n.deny %></paper-button> <paper-button id="report"><%= i18n.report %></paper-button> </div> </div> </div> </div> <div class="layout vertical chart-container flex"> <duma-chart type="line" id="ping-graph" just-hide-me-in-table-mode></duma-chart> </div> </div> <div class="flex layout vertical center center-justified" id="no-host"> <%= i18n.autoPingNoHost %> </div> <paper-dialog id="ping-loader-dialog" modal> <h2 dialog-label><%= i18n.applyingSettings %></h2> <div class="layout horizontal center-justified"> <paper-spinner-lite></paper-spinner-lite> </div> </paper-dialog> <paper-dialog id="report-dialog" modal> <h2 dialog-label id="report-header"><%= i18n.reportConnection %></h2> <paper-dialog-scrollable> <div class="inner layout vertical"> <paper-checkbox id="report-abnormal" aria-label="<%= i18n.abnormalPing %>"><%= i18n.abnormalPing %></paper-checkbox> <paper-checkbox id="report-wrong-server-class" aria-label="<%= i18n.wrongServerType %>"><%= i18n.wrongServerType %></paper-checkbox> <paper-checkbox id="report-is-master-server" aria-label="<%= i18n.masterServer %>"><%= i18n.masterServer %></paper-checkbox> <paper-checkbox id="report-other" aria-label="<%= i18n.otherReport %>"><%= i18n.otherReport %></paper-checkbox> <paper-textarea id="report-other-text" placeholder="<%= i18n.pleaseDescribe %>" rows="4" disabled="disabled" aria-label="<%= i18n.other %>"></paper-textarea> <paper-dropdown-menu id="country_dropdown" label="<%= i18n.country %>" aria-label="<%= i18n.country %>" required> <paper-listbox id="country_listbox" attr-for-selected="name" class="dropdown-content" selected="none"> <paper-item name="none"><%= i18n.noCountry %></paper-item> <template id="country_items" is="dom-repeat" as="country"> <paper-item name="[[country.name]]" index="[[index]]">[[country.name]]</paper-item> </template> </paper-listbox> </paper-dropdown-menu> <paper-dropdown-menu id="state_dropdown" label="<%= i18n.state %>" disabled="disabled" aria-label="<%= i18n.state %>"> <paper-listbox id="state_listbox" attr-for-selected="name" class="dropdown-content" selected="none"> <paper-item name="none"><%= i18n.noState %></paper-item> <template id="state_items" is="dom-repeat" as="state"> <paper-item name="[[state]]" index="[[index]]">[[state]]</paper-item> </template> </paper-listbox> </paper-dropdown-menu> </div> </paper-dialog-scrollable> <div class="buttons"> <paper-button dialog-dismiss aria-label="<%= i18n.cancel %>"><%= i18n.cancel %></paper-button> <paper-button id="report-send" disabled="disabled" aria-label="<%= i18n.sendReport %>"><%= i18n.sendReport %></paper-button> </div> </paper-dialog> </div> </duma-panel> <duma-alert id="ping-duma-alert"></duma-alert> <script src="/apps/com.netdumasoftware.geofilter/desktop/ping.js?v=<%= dumaos_version %>&lang=<%= lang %>&theme=<%= current_theme %>&themeVersion=<%= current_theme_version %>"></script> 